### 客户端协议处理和IPC通信

协议处理来自玩家设备的请求

#### IPC类型包括:

1. __同一__ 服务器的玩家到玩家通信(IPC)。
2. 位于 __不同__ 服务器的玩家通信(Remote IPC)，通过HUB转发消息。
3. 玩家调用某个HUB的功能（用户中心概念, 例如获取排名，分数信息，发起攻击等）。

#### P2P通信策略:   
首先检查玩家是否在本服务器上线， 如果上线，直接投递消息。如果不在线，Forward到HUB。    
HUB如果发现用户并未在任何一台GameServer上登陆（即:绝对离线），存消息至数据库。    
上线后，玩家goroutine启动过程会直接请求数据库，读取离线时的私有消息。
离线联盟消息HUB会直接发送到玩家。

#### CALL() 的实现（包的REQ/ACK机制)：
每一次call对应一个独立的请求号（数据包序列号, atomic.Add), ack的时候根据相应对应请求号，以唤醒某个阻塞的call。    


#### 附：二进制包测试方法
<pre>
 echo "000D 0001 0001 41 00000001 01 0001 42" | xxd -r -ps |nc 127.0.0.1 8888 -q 1|hexdump -C
</pre>
